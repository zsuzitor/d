
@{
    ViewBag.Title = "ListUserAct";
}

<h2>ListUserAct</h2>





<div class="ListUserAct_MainDiv">
    <div class="ListUserAct_OneColumn div_inline_block">
        <div>
            пользователи
            <input type="text" id="currentUserId_id" placeholder="Введите id пользователя"/>

            <button class="btn btn-default" onclick="LoadAllUsers()">Показать всех пользователей</button>
            <div id="ListAllUsers_id">

            </div>
        </div>
    </div><div class="ListUserAct_OneColumn div_inline_block">
              <div>
                  то что уже закреплено
                  <div>
                      <button class="btn btn-default" onclick="ShowAssignList()">Списки</button>
                      <button class="btn btn-default" onclick="ShowAssignPhys()">ФЭ</button>
                      <div class="OneUserOwnContent">
                          <div id="AssignsList_id" style="display:none;">
                              
                          </div>
                          <div id="AssignsPhys_id" style="display:none;">
                             
                          </div>
                          
                          
                      </div>
                      </div>


              </div>
    <hr />
              <div>
                  то что не закреплено
                  <div>
                      <button class="btn btn-default" onclick="ShowNotAssignList()">Списки</button>
                      <button class="btn btn-default" onclick="ShowNotAssignPhys()">ФЭ</button>
                     
                      <div class="OneUserNotOwnContent">
                          <div id="ForAssignsList_id" style="display:none;">
                              <input onchange="clearListFeLink()" type="number" id="newAssignList" />
                              <button  class="btn btn-default" onclick="AssignListToUser()">Присвоить</button>
                              <button class="btn btn-default" onclick="ShowLinkListFe()">Показать Ссылку на список</button>
                              <div id="divLinkCurrListFe_id"></div>
                              @*<div><p>список</p><button class="btn btn-default" onclick="">просмотр</button><button class="btn btn-default" onclick="">закинуть пользователю</button></div>*@
                          </div>
                          <div id="ForAssignsPhys_id" style="display:none;">
                              <input onchange="clearFeLink()" type="number" id="newAssignPhys" />
                              <button  class="btn btn-default" onclick="AssignPhysicToUser()">Присвоить</button>
                              <button class="btn btn-default" onclick="ShowLinkFetext()">Показать Ссылку на страницу ФЭ</button>
                              @*<a onclick="alert()">Страница ФЭ</a>*@
                              @*<div><p>ФЭ-ссылка</p><button class="btn btn-default" onclick="">закинуть пользователю</button></div>*@
                              <div id="divLinkCurrFetext_id"></div>
                          </div>
                          
                      </div>
                  </div>


              </div>
    </div>
    



</div>





<script>

    function ShowAssignList() {
        document.getElementById('AssignsList_id').style.display='block';

        document.getElementById('AssignsPhys_id').style.display = 'none';


        var formData = { iduser: document.getElementById('currentUserId_id').value };
        if (!formData.iduser.trim())
            alert('Введите id пользователя');
        goAjaxRequest({
            url: "/ListPhysics/AssignsUsersList",
            data: formData,
            func_success: function (req, status, jqXHR) {
                document.getElementById('AssignsList_id').innerHTML = req;

            }, type: 'GET'
        });



    }

    function ShowAssignPhys() {
        document.getElementById('AssignsList_id').style.display = 'none';

        document.getElementById('AssignsPhys_id').style.display = 'block';

        var formData = { iduser: document.getElementById('currentUserId_id').value };
        if (!formData.iduser.trim())
            alert('Введите id пользователя');
        goAjaxRequest({
            url: "/ListPhysics/AssignsUsersPhysics",
            data: formData,
            func_success: function (req, status, jqXHR) {
                document.getElementById('AssignsPhys_id').innerHTML = req;

            }, type: 'GET'
        });
    }
    

    function ShowNotAssignList() {
        document.getElementById('ForAssignsList_id').style.display = 'block';

        document.getElementById('ForAssignsPhys_id').style.display = 'none';


        



    }

    function ShowNotAssignPhys() {
        document.getElementById('ForAssignsList_id').style.display = 'none';

        document.getElementById('ForAssignsPhys_id').style.display = 'block';

        
    }


    function AssignListToUser() {
        
        var formData = { iduser: document.getElementById('currentUserId_id').value, idlist:document.getElementById('newAssignList').value };
        //string iduser, int idlist)
        goAjaxRequest({
            url: "/ListPhysics/AssignListToUser",
            data: formData,
            func_success: function (req, status, jqXHR) {
                alert('result AssignListToUser');

            }, type: 'POST'
        });
        
    }

    function AssignPhysicToUser() {
        var formData = { iduser: document.getElementById('currentUserId_id').value, idphys: document.getElementById('newAssignPhys').value };
        //string iduser, int idlist)
        goAjaxRequest({
            url: "/ListPhysics/AssignPhysicToUser",
            data: formData,
            func_success: function (req, status, jqXHR) {
                alert('result AssignListToUser');

            }, type: 'POST'
        });
    }
    

    function ShowLinkFetext() {
        let link = '/Physic/Details/';
        let idfe = document.getElementById("newAssignPhys").value;
        link += idfe;
        let tegA = '<a href="'+link+'">Страница ФЭ</a>' ;
        if (idfe) 
            document.getElementById('divLinkCurrFetext_id').innerHTML = tegA;
    }
    function clearFeLink() {
        document.getElementById('divLinkCurrFetext_id').innerHTML = '';
    }

    function ShowLinkListFe() {
        let link = '/ListPhysics/ListAct?currentListId=';
        let idfe = document.getElementById("newAssignList").value;
        link += idfe;
        let tegA = '<a href="' + link + '">Страница просмотра списка</a>';
        if (idfe)
            document.getElementById('divLinkCurrListFe_id').innerHTML = tegA;
    }

    function clearListFeLink() {
        document.getElementById('divLinkCurrListFe_id').innerHTML = '';
    }


    function ShowLinkFetextExist() {
        let link = '/Physic/Details/';
        let idfe = document.getElementById("AssignPhysForDel").value;
        link += idfe;
        let tegA = '<a href="' + link + '">Страница ФЭ</a>';
        if (idfe)
            document.getElementById('divLinkCurrFetextExist_id').innerHTML = tegA;
    }
    function clearFeExistLink() {
        document.getElementById('divLinkCurrFetextExist_id').innerHTML = '';
    }

    function ShowLinkListFeExist() {
        let link = '/ListPhysics/ListAct?currentListId=';
        let idfe = document.getElementById("AssignListForDel").value;
        link += idfe;
        let tegA = '<a href="' + link + '">Страница просмотра списка</a>';
        if (idfe)
            document.getElementById('divLinkCurrListFeExist_id').innerHTML = tegA;
    }

    function clearListFeLinkExist() {
        document.getElementById('divLinkCurrListFeExist_id').innerHTML = '';
    }


    function removeListFromUser(id) {
        if (!id) 
            id = document.getElementById('AssignListForDel').value;

        if (!id) {
            alert('Не выбран список');
            return;
        }
            
        var formData = { iduser: document.getElementById('currentUserId_id').value, idlist: id };
       
        goAjaxRequest({
            url: "/ListPhysics/RemoveListFromUser",
            data: formData,
            func_success: function (req, status, jqXHR) {
                alert('result removeListFromUser');

            }, type: 'POST'
        });

    }

    function removePhysFromUser(id) {
        if (!id) 
            id = document.getElementById('AssignPhysForDel').value;
            
        if (!id) {
            alert('Не выбран список');
            return;
        }

        var formData = { iduser: document.getElementById('currentUserId_id').value, idphys: id };

        goAjaxRequest({
            url: "/ListPhysics/RemovePhysicFromUser",
            data: formData,
            func_success: function (req, status, jqXHR) {
                alert('result removePhysFromUser');

            }, type: 'POST'
        });
    }




    function LoadAllUsers() {
        var formData = { };


       
        
        goAjaxRequest({
            url: "/Admin/GetAllUsersShortData",
            data: formData,
            func_success: function (req, status, jqXHR) {
                document.getElementById('ListAllUsers_id').innerHTML = req;

            }, type: 'GET'
        });
    }


</script>