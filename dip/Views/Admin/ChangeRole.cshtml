@model dip.Models.ViewModel.AdminV.ChangeRoleV
@{
    ViewBag.Title = "AddRole";
}

<h2>ChangeRole</h2>


<div>
    <select class="cursor_pointer form-control" name="roleName" id="roleNameSelect_id">
        @foreach (var i in Model.Roles)
        {
            <option value="@i">@i</option>
        }
    </select>
    <button class="btn btn-default" onclick="AddRole()">Выдать роль</button>
    <button class="btn btn-default" onclick="RemoveRole()">Забрать роль</button>
    <hr />
    <p>Введите id пользователя или выберите пользователя из списка</p>
    <input onchange="changeUserId()" placeholder="id пользователя" class="form-control" name="userId" id="userIdInput_id" type="text" />
   

    <p>Присвоенные роли можно просмотреть на странице пользователя</p>
    <button class="btn btn-default" onchange="clearLinkUser()" onclick="showLinkCurUser()">Показать ссылку на страницу пользователя</button>
    <div id="idCurrentUser_id"></div>

</div>






<script>

    function changeUserId() {
        document.getElementById('idCurrentUser_id').innerHTML = '';
    }


    function clearLinkUser() {
        document.getElementById('idCurrentUser_id').innerHTML = '';
    }

    function showLinkCurUser() {
        let id = document.getElementById('userIdInput_id').value;
        if (id) {
            let strLink = '/Person/PersonalRecord?personId=' + id;
            document.getElementById('idCurrentUser_id').innerHTML = '<a href="'+strLink+'">Страница пользователя</a>';
        }
        else
            alert('Введите id пользователя');
        
    }



    function AddRole() {
        var formData = {
            userId: document.getElementById('userIdInput_id').value,
            roleName: document.getElementById('roleNameSelect_id').value
        };
        goAjaxRequest({
            url: "/Admin/AddRole",
            data: formData,
            func_success: function (req, status, jqXHR) {
                alert(req)

            }, type: 'POST'
        });
    }


    function RemoveRole() {
        var formData = {
            userId: document.getElementById('userIdInput_id').value,
            roleName: document.getElementById('roleNameSelect_id').value
        };
        goAjaxRequest({
            url: "/Admin/RemoveRole",
            data: formData,
            func_success: function (req, status, jqXHR) {
                //alert('Роль успешно удалена')
                alert(req)
            }, type: 'POST'
        });
    }

   
   
</script>