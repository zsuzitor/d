


@model dip.Models.ViewModel.SearchV.TextSearchV


@{
    ViewBag.Title = "TextSearch";
}

<h2>TextSearch</h2>


<div>
    <div class="div_inline_block textSearchMainHalf">
        <div>
        <textarea id="TextForSearch_id" placeholder="Введите текст"></textarea>
        </div>
        <div id="InfoCurrentTypeSearch"></div>
    </div><div  class="div_inline_block textSearchMainHalf">
        <div>выбор типа поиска
            <div id="divTypesSearch_id">
                <p>
<input name="searchTypeRadio" type="radio" class="radioClass" id="lucene_radio" value="lucene" />
                    <label for="lucene_radio">lucene</label>
</p>
                <p>
<input name="searchTypeRadio" type="radio" class="radioClass" id="fullTextSearchF_radio" value="fullTextSearchF" />
                    <label for="fullTextSearchF_radio">fullTextSearchF</label></p>
                
                <p>
<input name="searchTypeRadio" type="radio" class="radioClass" id="fullTextSearchCf_radio" value="fullTextSearchCf" />
                    <label for="fullTextSearchCf_radio">fullTextSearchCf</label></p>
                
                <p>
<input name="searchTypeRadio" type="radio" class="radioClass" id="fullTextSearchCl_radio" value="fullTextSearchCl" />
                    <label for="fullTextSearchCl_radio">fullTextSearchCl</label></p>
                
                <p>
<input name="searchTypeRadio" type="radio" class="radioClass" id="fullTextSearchNear_radio" value="fullTextSearchNear" />
                    <label for="fullTextSearchNear_radio">fullTextSearchNear</label></p>
               
                <p>
<input name="searchTypeRadio" type="radio" class="radioClass" id="fullTextSearchSemantic_radio" value="fullTextSearchSemantic" />
                    <label for="fullTextSearchSemantic_radio">fullTextSearchSemantic</label></p>
                
            </div>
    
    </div>
    <button class="btn btn-default">Поиск</button>
    </div>
</div>












<div id="div_search_ft_result_id">
    @*@Html.Action("ListFeText", "Physic", new { listId = Model.ListPhysId.ToArray() })*@


</div>
@*@if (Model.ShowBtLoad != false)
{*@
    <p class="text-center">
        <div class="div_search_ft_but" style="display:none;" id="div_search_ft_but_id">
            <button class="width_100per btn btn-default" onclick="loadMoreFT()">загрузить еще</button>
        </div>
    </p>
@*}*@


<script>
    $(document).on('change', ':radio', function () {

        if (this.name == 'searchTypeRadio') {
            let infodiv = document.getElementById('InfoCurrentTypeSearch');
            let strInfo='';
            switch (this.value) {

                case 'lucene':
                    strInfo='Полнотекстовый поиск lucene';
                    break;


                case 'fullTextSearchF':
                    strInfo = 'Обычный полнотекстовый поиск fullTextSearch';
                    break;

                case 'fullTextSearchCf':
                    strInfo = 'Поиск форм слов, можно использовать (#слово) для повышения важности слова';
                    break;

                case 'fullTextSearchCl':
                    strInfo = 'Поиск по вхождениям, можно использовать (#слово) для повышения важности слова';
                    break;

                case 'fullTextSearchNear':
                    strInfo = 'Поиск фразы, включенные слова ищутся рядом с другими включенными словами';
                    break;

                case 'fullTextSearchSemantic':
                    strInfo = 'Семантический поиск';
                    break;

               
            }
            infodiv.innerHTML = strInfo
            
        }

    });






    var block_load = false;
   // var NumLoad = 2;
    function loadMoreFT() {

        //если вернулся пустой список то возвращать статус серва с ошибкой, блокировать множественное нажатие кнопки

        if (!block_load) {
            block_load = true;

            var formData = {
                
                str: document.getElementById('TextForSearch_id').value
            };
            $('#divTypesSearch_id input:radio:checked').each(function () {//[type=checkbox] 
                //curListId = this.id.split('ListPhysExistItem_')[1];
                formData.type = this.value;
            }); 



            
            var div_last_load_c = document.getElementById('div_search_ft_result_id').children;
            if (div_last_load_c.length > 0) {
                var div_last_load = div_last_load_c[div_last_load_c.length - 1];
                formData.countLoad = +div_last_load.id.split('_')[6] + 1;
                var div_last_fe_c = div_last_load.children;
                var div_last_fe = div_last_fe_c[div_last_fe_c.length - 1];
                formData.lastId = div_last_fe.id.split('_')[5];
            }
           
            goAjaxRequest({
                url: '/Search/TextSearchPartial',
                data: formData,
                func_success: function (req, status, jqXHR) {
                    if (jqXHR.status == 204) {
                        document.getElementById('div_search_ft_but_id').innerHTML = '';
                    }
                    else {
                        document.getElementById('div_search_ft_but_id').style.display = 'block';
                        var div = document.getElementById('div_search_ft_result_id');
                        div.innerHTML += req;
                        //NumLoad++;
                        block_load = false;
                    }
                    

                }, type: 'GET',
                beforeSend: function () {
                   
                }
                
            });
        }


    }


    ;
</script>